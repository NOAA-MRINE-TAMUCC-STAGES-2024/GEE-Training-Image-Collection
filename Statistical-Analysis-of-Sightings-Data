CREAT YOUR LIST OF IMAGES FIRST
You will need your list of GEE Sentinal images, and an excel file listing sightings data to complete this step. Our Excel files were named "spreadsheet_of_google_images_meta_data.xlsx" and "sightings.xlsx" respectively.
This code will create an excel file called "sightings_statistics.xlsx"
Run some statistics on the "sightings" excel file to find out which 3 months had the most sightings and list all of the sightings in those 3 months in a new excel sheet named "sightings_statistics". then in sheet 2 of the excel file, list how many sightings are in each of those months for all of the years of data. And a third sheet that lists the top 3 years for those top 3 months.

import os
import pandas as pd

# Verify the directory exists
output_directory = "/content/drive/MyDrive/Colab Notebooks"
if not os.path.exists(output_directory):
    print(f"Directory does not exist: {output_directory}")
else:
    print(f"Directory exists: {output_directory}")

# Read the Excel file
input_file = os.path.join(output_directory, "sightings.xlsx")
print(f"Reading input file: {input_file}")
df = pd.read_excel(input_file)

# Convert the 'Date' column to datetime
df['Date'] = pd.to_datetime(df['Date'])

# Extract the month and year from the 'Date' column
df['Month'] = df['Date'].dt.month
df['Year'] = df['Date'].dt.year

# Find the three months with the most sightings
top_months = df['Month'].value_counts().nlargest(3).index.tolist()
print(f"Top 3 months with most sightings: {top_months}")

# Filter the DataFrame to include only sightings from the top three months
filtered_df = df[df['Month'].isin(top_months)]

# Create a new DataFrame for sheet 2 with sightings per month for each year
sightings_per_month_year = (
    filtered_df.groupby(['Month', 'Year']).size().reset_index(name='Sightings')
)

# Sort the filtered data by Month and Year
filtered_df_sorted = filtered_df.sort_values(by=['Month', 'Year'])
sightings_per_month_year_sorted = sightings_per_month_year.sort_values(by=['Month', 'Year'])

# Create a new DataFrame for sheet 3 with top 3 years for top 3 months
top_years_per_month = filtered_df.groupby(['Month', 'Year']).size().reset_index(name='Sightings')
top_years_per_month = top_years_per_month.groupby('Month').apply(lambda x: x.nlargest(3, 'Sightings')).reset_index(drop=True)

# Create a new Excel file with the filtered sightings and sightings per month/year
output_file = os.path.join(output_directory, "sightings_statistics.xlsx")
print(f"Writing output file: {output_file}")

with pd.ExcelWriter(output_file) as writer:
    filtered_df_sorted.to_excel(writer, sheet_name='Top 3 Months Sightings', index=False)
    sightings_per_month_year_sorted.to_excel(writer, sheet_name='Sightings Per Month', index=False)
    top_years_per_month.to_excel(writer, sheet_name='Top 3 Years for Top 3 Months', index=False)

print(f"The new Excel file with the sightings from the top 3 months, monthly sightings summary, and top 3 years for top 3 months has been created at {output_file}")

Our analysis showed that the months of March, April, and May had the most noted sightings of Giant Manta Rays.

This code will create a new excel sheet called "google_images_statistically_likely.xlsx" that lists all of the images taken from GEE Sentinal satelites over our area of interest during March, April, and May.

import os
import pandas as pd

# Paths to input files
google_images_file = "/content/drive/MyDrive/Colab Notebooks/spreadsheet_of_google_images_meta_data.xlsx"

try:
    # Read Google images metadata with proper date parsing
    google_images_df = pd.read_excel(google_images_file, parse_dates=['Date'])

    # Filter Google images metadata to include only images from March, April, and May
    selected_months = [3, 4, 5]  # March, April, May
    google_images_filtered = google_images_df[google_images_df['Date'].dt.month.isin(selected_months)]

    # Save filtered Google images metadata to a new Excel sheet
    output_directory = "/content/drive/MyDrive/Colab Notebooks"
    output_file = os.path.join(output_directory, "google_images_statistically_likely.xlsx")
    print(f"Writing output file: {output_file}")

    with pd.ExcelWriter(output_file) as writer:
        google_images_filtered.to_excel(writer, sheet_name='Google Images Statistically Likely', index=False)

    print(f"The new Excel file with the images taken in March, April, and May has been created at {output_file}")

except Exception as e:
    print(f"Error processing Google images metadata: {e}")
